<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../lib/iconfont.css">

    <title> iFruit Cloud Music</title>
</head>

<body>
    <div class="front-panel-box" id="frontPanel">
        <div class="front-panel">

            <div class="front-panel-head">
                <div class="go-back" onclick="goBack()">&lt;返回</div>
            </div>
            <div class="main-area">
                <div class="main-area-left">
                    <img src="../img/IMG_8603.JPG" alt="">
                    <div class="disk-info">XX首歌曲，XXXXX小时XX分钟</div>
                    <div class="play-bottom-box">
                        <div class="play-bottom">播放</div>
                        <div class="play-bottom">随机播放</div>
                    </div>
                    <div class="description">这是测试页面用这是测试页面用这是测试页面用这是测试页面用这是测试页面用这是测试页面用这是测试页面用这是测试页面用</div>
                </div>
                <div class="main-area-right">
                    <div class="front-panel-disk-info">
                        <div class="front-panel-disk-name">
                            这是歌单名称允许换行换个行换个行换个行换个行换个行换个行
                        </div>
                        <div class="front-panel-disk-creator">
                            作者名字-亚历山大·冯·法尔肯豪森
                        </div>
                    </div>
                    <div class="front-panel-song-list">
                        <div class="front-panel-song">
                            <div class="song-num">9999</div>
                            <div class="song-name">Kimino Shiranai Monogatari</div>
                            <div class="song-artist">supercell</div>
                            <div class="song-length">5:40</div>
                        </div>
                        <div class="front-panel-song">
                            <div class="song-num">9999</div>
                            <div class="song-name">Kimino Shiranai Monogatari</div>
                            <div class="song-artist">supercell</div>
                            <div class="song-length">5:40</div>
                        </div>
                        <div class="front-panel-song">
                            <div class="song-num">9999</div>
                            <div class="song-name">Kimino Shiranai Monogatari</div>
                            <div class="song-artist">supercell</div>
                            <div class="song-length">5:40</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- ======= -->
    <div class="top-bar">
        <div class="left-site">
            <div class="current-time">M月D日 EEE</div>
            <div class="bigest-title">为你推荐</div>
        </div>
        <a class="user-avatar" href="JavaScript:void(0)" onclick="test()">
            <img src="../img/350px-Madogatari_Queen.png" alt="">
        </a>
    </div>
    <!-- = -->
    <div class="list">
        <div class="list-title">
            <div class="list-title-text" onclick="fu()">
                推荐歌单
            </div>
            <a class="view-all" href="JavaScript:void(0)">
                显示全部
            </a>
        </div>
        <div class="list-items">
            <div class="left-arrow" id="recommendDiskLArr" onclick="leftRoll('recommendDisk')">&lt;</div>
            <div class="disk-box" id="recommendDisk">

            </div>
            <div class="right-arrow" id="recommendDiskLArr" onclick="rightRoll('recommendDisk')">&gt;</div>
        </div>
    </div>
    <!-- = -->
    <div class="list">
        <div class="list-title">
            <div class="list-title-text">
                网友精选碟
            </div>
            <a class="view-all" href="JavaScript:void(0)">
                显示全部
            </a>
        </div>
        <div class="list-items">
            <div class="left-arrow" id="hotestDiskLArr" onclick="leftRoll('hotestDisk')">&lt;</div>
            <div class="disk-box" id="hotestDisk">
                <!-- Wait for ajax.. -->
            </div>
            <div class="right-arrow" id="hotestDiskRArr" onclick="rightRoll('hotestDisk')">&gt;</div>
        </div>
    </div>
    <!-- = -->
    <div class="list">
        <div class="list-title">
            <div class="list-title-text">
                新碟上架
            </div>
            <a class="view-all" href="JavaScript:void(0)">
                显示全部
            </a>
        </div>
        <div class="list-items">
            <div class="left-arrow" id="newDiskLArr" onclick="leftRoll('newDisk')">&lt;</div>
            <div class="disk-box" id="newDisk">

            </div>
            <div class="right-arrow" id="newDiskRArr" onclick="rightRoll('newDisk')">&gt;</div>
        </div>
    </div>
    <!-- = -->
    <div class="bottom"></div>

    <!-- = -->
    <div class="sub-bar">
        <div class="glass"></div>
        <div class="ctrl-panel">
            <div class="ctrl-item-box">
                <div class="ctrl-item">
                    <span class="iconfont icon-AppleMusic my-icon"></span>
                    <div class="ctrl-text">资料库</div>
                </div>
            </div>
            <div class="ctrl-item-box">
                <div class="ctrl-item">
                    <span class="iconfont icon-aixin my-icon"></span>
                    <div class="ctrl-text">为你推荐</div>
                </div>
            </div>
            <div class="ctrl-item-box">
                <div class="ctrl-item">
                    <span class="iconfont icon-sousuo my-icon"></span>
                    <div class="ctrl-text">搜索</div>
                </div>
            </div>
        </div>
        <div class="line"></div>
        <div class="player">
            <img src="../img/IMG_8603.JPG" alt="" class="current-img">
            <div class="current-song" id="currentSong">Overflow_Overflow_Overflow_Overflow_Overflow</div>
            <div class="play" id="play">
                <span class="iconfont icon-qiyong tools"></span>
            </div>
            <!-- <div class="pause" id="pause">
                <span class="iconfont icon-zanting tools"></span>
            </div> -->
            <div class="next-song">
                <span class="iconfont icon-ai-rew-right tools"></span>
            </div>
        </div>
    </div>

</body>

<script>
    fetch('http://www.huishiguang.com:3000/top/playlist?limit=16&order=hot', {
            method: "get",
            mode: "cors"
        })
        .then(function (r) {
            //console.log(r);
            return r.json()
        })
        .then(function (data) {
            let strHtml = "";
            //console.log(data)
            data.playlists.forEach(element => {
                //console.log(element.name)

                strHtml += `<div class="disk">
                    <img src="${element.coverImgUrl}" alt="">
                    <div class="disk-name">${element.name}</div>
                </div>`;
            });
            let temp = document.getElementById("hotestDisk");
            temp.style.width = (250 * 16 + 100) + 'px';
            temp.innerHTML = strHtml;
        });
    fetch('http://www.huishiguang.com:3000/album/newest', {
            method: "get",
            mode: "cors"
        })
        .then(function (r) {
            // console.log(r);
            return r.json()
        })
        .then(function (data) {
            let strHtml = "";
            //console.log(data)
            data.albums.forEach(element => {
                //console.log(element.name)

                strHtml += `<div class="disk" onclick="shit()">
                    <img src="${element.blurPicUrl}" alt="">
                    <div class="disk-name">${element.name}</div>
                </div>`;
            });
            let temp = document.getElementById("newDisk");
            temp.style.width = (250 * 16 + 100) + 'px';
            temp.innerHTML = strHtml;
        });
    fetch('http://www.huishiguang.com:3000/personalized?limit=16', {
            method: "get",
            mode: "cors"
        })
        .then(function (r) {
            // console.log(r);
            return r.json()
        })
        .then(function (data) {
            let strHtml = "";
            // console.log(data)
            data.result.forEach(element => {
                //console.log(element.name)

                strHtml += `<div class="disk">
                    <img src="${element.picUrl}" alt="">
                    <div class="disk-name">${element.name}</div>
                </div>`;
            });
            let temp = document.getElementById("recommendDisk");
            temp.style.width = (250 * 16 + 100) + 'px';
            temp.innerHTML = strHtml;
        });
    
    function goBack(){
        let node = document.getElementById("frontPanel");
        node.style.left="100%";
    }
    function shit() {
        console.log("shit!");
    }

    function test() {
        console.log("debug");
        let node = document.getElementById("frontPanel");
        node.style.left="0%";
        console.log(window.getComputedStyle(node,null).left);
    }

    function play(id) {
        let temp = document.getElementById(id);
        temp.innerHTML =
            `<audio controls="controls" src="https://music.163.com/song/media/outer/url?id=${id}.mp3"></audio>`;
    }

    function rightRoll(id) {
        let node = document.getElementById(id);
        //获取当前盒
        let boxWidth = document.body.clientWidth * 0.9;
        let fullDisplayCount = Math.floor(boxWidth / 250);
        let originalMarginL = parseInt(window.getComputedStyle(node, null).marginLeft);
        originalMarginL = Math.floor(originalMarginL / 250) * 250;
        if (originalMarginL - boxWidth > node.childElementCount * -250) {
            let marginL = originalMarginL - fullDisplayCount * 250;
            node.style.marginLeft = marginL + 'px';
        }
    }

    function leftRoll(id) {
        let node = document.getElementById(id);
        //获取当前盒
        let boxWidth = document.body.clientWidth * 0.9;
        //先看他移动了多少
        let originalMarginL = parseInt(window.getComputedStyle(node, null).marginLeft);
        originalMarginL = Math.floor(originalMarginL / 250) * 250;
        if (originalMarginL < 0) {
            let marginL = originalMarginL + Math.floor(boxWidth / 250) * 250;
            if (marginL > 0) {
                marginL = 0;
            }
            node.style.marginLeft = marginL + 'px';
        }
    }

    function fu() {
        fetch('http://www.huishiguang.com:3000/top/playlist?limit=16&order=hot', {
                method: "get",
                mode: "cors"
            })
            .then(function (r) {
                console.log(r);
                return r.json()
            }).then(function (data) {
                console.log(data);
            })
    }
</script>

</html>